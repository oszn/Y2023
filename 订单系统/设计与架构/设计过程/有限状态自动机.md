# FSM

封装状态机的三个要素1）状态 2）事件 3）动作

## 什么是FSM

### 动作

1. 下订单
2. 支付
3. 用户取消订单
4. 下订单直接支付
5. 超时取消订单
6. 用户选择退款
7. 商家主动取消订单
8. 商家确定退款

### 状态

1. 初始化
2. 待支付
3. 待收货
4. 退款中
5. 已退款

### 事件

订单创建完成

支付成功

支付失败

取消成功

取消失败

## 解决问题

1. 幂等性问题

状态本身就是一个量，对于多个请求，如果状态发生改变则整体过程失效，更新也失效。

2. 超买问题

pass



